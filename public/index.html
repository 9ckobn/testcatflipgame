<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Unity WebGL Player | Catflip Run</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      overflow: hidden;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: url('1.png') no-repeat center center;
      background-size: cover;
    }

    #loading-bar-container {
      width: 80%;
      height: 30px;
      background-color: #e0e0e0;
      border-radius: 15px;
      overflow: hidden;
      position: absolute;
      bottom: 10%;
      left: 10%;
      right: 10%;
    }

    #loading-bar {
      height: 100%;
      width: 0%;
      background-color: #FF6B00;
      border-radius: 15px 0 0 15px;
      transition: width 0.3s;
    }

    canvas {
      display: none;
    }
  </style>
</head>
<body>
<canvas id="unity-canvas" width=645 height=1398></canvas>
<div id="loading-bar-container">
  <div id="loading-bar"></div>
</div>

<script src="Build/36c69a970bbbf468f4a412b485f7c710.loader.js"></script>
<script>
  if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
    var meta = document.createElement('meta');
    meta.name = 'viewport';
    meta.content = 'width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes';
    document.getElementsByTagName('head')[0].appendChild(meta);

    var canvas = document.querySelector("#unity-canvas");
    canvas.style.width = "100%";
    canvas.style.height = "100%";
    canvas.style.position = "fixed";

    document.body.style.textAlign = "left";
  }

  var loadingBar = document.getElementById('loading-bar');

  createUnityInstance(document.querySelector("#unity-canvas"), {
    dataUrl: "Build/1aca80a758fe79966c09c82d71edc7d1.data.br",
    frameworkUrl: "Build/61a45b0a4b81fa32c18230e2fbfc4d67.framework.js.br",
    codeUrl: "Build/bd61cf2a732b95e6d68dd114aef59877.wasm.br",
    streamingAssetsUrl: "StreamingAssets",
    companyName: "Catflip IO",
    productName: "Catflip Run",
    productVersion: "0.1",
    onProgress: function(unityInstance, progress) {
      loadingBar.style.width = (progress * 100) + '%';
      if (progress === 1) {
        document.getElementById('loading-bar-container').style.display = 'none';
        document.querySelector('canvas').style.display = 'block';
      }
    }
  }).then((unityInstance) => {
    const initData = Telegram.WebApp.initDataUnsafe;
    const userData = {
      user: initData.user,
      referral: initData.start_param
    };
    unityInstance.SendMessage('Boot', 'SetUserRaw', JSON.stringify(userData));

    Telegram.WebApp.expand();
  });

  function ShareInviteLink(url) {
    window.location.href = url;
  }

  function OpenUrl(url) {
    Telegram.WebApp.openLink(url);
  }
</script>
</body>
</html>
